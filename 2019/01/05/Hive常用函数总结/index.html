<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/avatar-6.png?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, Jony">










<meta name="description" content="关系运算 等值比较：=  语法：A=B  操作类型：所有基本类型  描述：如果表达式A与表达式B相等，则为True，否则为False  举例：  12hive&amp;gt; select 1 from lxw_dual where 1=1;1">
<meta property="og:type" content="article">
<meta property="og:title" content="Hive常用函数总结">
<meta property="og:url" content="http://yoursite.com/2019/01/05/Hive常用函数总结/index.html">
<meta property="og:site_name" content="My Love">
<meta property="og:description" content="关系运算 等值比较：=  语法：A=B  操作类型：所有基本类型  描述：如果表达式A与表达式B相等，则为True，否则为False  举例：  12hive&amp;gt; select 1 from lxw_dual where 1=1;1">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://www.tertiarycourses.com.sg/media/catalog/product/cache/1/image/512x/040ec09b1e35df139433887a97daa66f/a/p/apache-hive_1.jpg">
<meta property="og:updated_time" content="2020-04-27T03:00:32.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hive常用函数总结">
<meta name="twitter:description" content="关系运算 等值比较：=  语法：A=B  操作类型：所有基本类型  描述：如果表达式A与表达式B相等，则为True，否则为False  举例：  12hive&amp;gt; select 1 from lxw_dual where 1=1;1">
<meta name="twitter:image" content="https://www.tertiarycourses.com.sg/media/catalog/product/cache/1/image/512x/040ec09b1e35df139433887a97daa66f/a/p/apache-hive_1.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/01/05/Hive常用函数总结/">





  <title>Hive常用函数总结 | My Love</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
<a href="https://github.com/jiaoqiyuan" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">My Love</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">I will be stronger</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-主页">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            主页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-关于我">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于我
          </a>
        </li>
      
        
        <li class="menu-item menu-item-标签">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-分类">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-归档">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/05/Hive常用函数总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jony Chiao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar-6.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My Love">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Hive常用函数总结</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-05T09:53:33+08:00">
                2019-01-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/01/05/Hive常用函数总结/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count gitment-comments-count" data-xid="/2019/01/05/Hive常用函数总结/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i> 浏览
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>次
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  7k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  31
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      
        <div class="post-gallery" itemscope itemtype="http://schema.org/ImageGallery">
          
          
            <div class="post-gallery-row">
              <a class="post-gallery-img fancybox" href="https://www.tertiarycourses.com.sg/media/catalog/product/cache/1/image/512x/040ec09b1e35df139433887a97daa66f/a/p/apache-hive_1.jpg" rel="gallery_ckm0dle0x005rcnttegyg83k5" itemscope itemtype="http://schema.org/ImageObject" itemprop="url">
                <img src="https://www.tertiarycourses.com.sg/media/catalog/product/cache/1/image/512x/040ec09b1e35df139433887a97daa66f/a/p/apache-hive_1.jpg" itemprop="contentUrl">
              </a>
            
          

          
          </div>
        </div>
      

      
        <h2 id="关系运算"><a href="#关系运算" class="headerlink" title="关系运算"></a>关系运算</h2><ol>
<li><p>等值比较：=</p>
<p> 语法：A=B</p>
<p> 操作类型：所有基本类型</p>
<p> 描述：如果表达式A与表达式B相等，则为True，否则为False</p>
<p> 举例：</p>
 <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select <span class="number">1</span> from lxw_dual where <span class="number">1</span>=<span class="number">1</span>;</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<a id="more"></a>
<ol start="2">
<li><p>不等值比较：&lt;&gt;</p>
<p> 语法：A &lt;&gt; B</p>
<p> 操作类型：所有基本类型</p>
<p> 描述：如果表达式A为NULL，或者表达式B为NULL，返回NULL；如果表达式A与表达式B不相等，则为True，否则为False</p>
<p> 举例：</p>
 <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select <span class="number">1</span> from lxw_dual where <span class="number">1</span>&lt;&gt;<span class="number">2</span>;</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>小于比较：&lt;</p>
<p> 语法：A &lt; B</p>
<p> 操作类型：所有基本类型</p>
<p> 描述：如果表达式A或B为NULL，返回NULL，如果表达式A小于表达式B，则为True，否则为False</p>
<p> 举例：</p>
 <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select <span class="number">1</span> from lxw_dual where <span class="number">1</span> &lt; <span class="number">2</span>;</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>小于等于比较：&lt;=</p>
<p> 语法：A &lt;= B</p>
<p> 操作类型：所有基本类型</p>
<p> 描述：如果表达式A或B为NULL，返回NULL，如果表达式A小于或等于表达式B，则为True，否则为False</p>
<p> 举例：</p>
 <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select <span class="number">1</span> from lxw_dual where <span class="number">1</span> &lt;= <span class="number">1</span>;</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>大于比较：&gt;</p>
<p> 语法：A &gt; B</p>
<p> 操作类型：所有基本类型</p>
<p> 描述：如果表达式A或B为NULL，返回NULL，如果表达式A大于表达式B，则为True，否则为False</p>
<p> 举例：</p>
 <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select <span class="number">1</span> from lxw_dual where <span class="number">2</span> &gt; <span class="number">1</span>;</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>大于等于比较：&gt;=</p>
<p> 语法：A &gt;= B</p>
<p> 操作类型：所有基本类型</p>
<p> 描述：如果表达式A或B为NULL，返回NULL，如果表达式A大于或等于表达式B，则为True，否则为False</p>
<p> 举例：</p>
 <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select <span class="number">1</span> from lxw_dual where <span class="number">1</span> &gt;= <span class="number">1</span>;</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
<p> <strong>注意：对String类型的比较要注意（常用时间比较可以先to_data之后再比较）</strong></p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> * <span class="keyword">from</span> lxw;</span><br><span class="line"><span class="number">2011111209</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="number">2011111209</span></span><br><span class="line"></span><br><span class="line">hive&gt; <span class="keyword">select</span> a, b, a &lt; b, a &gt; b, a = b <span class="keyword">from</span> lxw_dual;</span><br><span class="line"><span class="number">2011111209</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="number">2011111209</span> <span class="literal">false</span> <span class="literal">true</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>空值判断：IS NULL</p>
<p> 语法：A IS NULL</p>
<p> 操作类型：所有基本类型</p>
<p> 描述：如果表达式A为NULL，则返回True，否则为False</p>
<p> 举例：</p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> lxw_dual <span class="keyword">where</span> <span class="literal">null</span> <span class="keyword">is</span> <span class="literal">null</span>;</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
</li>
<li><p>非空判断：IS NOT NULL</p>
<p> 语法：A IS NOT NULL</p>
<p> 操作类型：所有基本类型</p>
<p> 描述：如果表达式A为NULL，则返回False，否则为True</p>
<p> 举例：</p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> lxw_dual <span class="keyword">where</span> <span class="number">1</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>;</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
</li>
<li><p>LIKE比较：LIKE</p>
<p> 语法：A LIKE B</p>
<p> 操作类型：strings</p>
<p> 描述：如果字符串A或者字符串B为NULL， 则返回NULL；如果字符串A符合表达式B的正则语法，则为True，否则为False。B中字符”_”表示任意单个字符，字符”%”表示任意数量的字符。</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> lxw_dual <span class="keyword">where</span> <span class="string">'football'</span> like <span class="string">'foot%'</span>;</span><br><span class="line"><span class="number">1</span></span><br><span class="line">hive&gt; <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> lxw_dual <span class="keyword">where</span> <span class="string">'football'</span> like <span class="string">'foot____'</span>;</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
<p> <strong>注意：否定比较时候用NOT A LIKE B</strong></p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> lxw_dual <span class="keyword">where</span> <span class="keyword">NOT</span> <span class="string">'football'</span> <span class="keyword">like</span> <span class="string">'fff%'</span>;</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
</li>
<li><p>Java的LIKE操作：RLIKE</p>
<p>语法：A RLIKE B</p>
<p>操作类型： strings</p>
<p>描述：如果字符串A或字符串B为NULL，则返回NULL；如果字符串A符合Java正则表达式B的正则语法，则为True，否则为False。</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> lxw_dual <span class="keyword">where</span> <span class="string">'footbar'</span> rlike <span class="string">'^f.*r$'</span>;</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
<p><strong>注意：判断一个字符串是否为数字</strong></p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> lxw_dual <span class="keyword">where</span> <span class="string">'123456'</span> rlike <span class="string">'^\\d+$'</span>;</span><br><span class="line"><span class="number">1</span></span><br><span class="line">hive&gt; <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> lxw_dual <span class="keyword">where</span> <span class="string">'123456aaa'</span> rlike <span class="string">'^\\d+$'</span>;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="11">
<li><p>REGEXP操作：REGEXP</p>
<p>语法：A REGEXP B</p>
<p>操作类型：strings</p>
<p>描述：功能与RLIKE相同</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> lxw_dual <span class="keyword">where</span> <span class="string">'footbar'</span> REGEXP <span class="string">'^f.*r$'</span>;</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="数学运算"><a href="#数学运算" class="headerlink" title="数学运算"></a>数学运算</h2><ol>
<li><p>加法操作：+</p>
<p> 语法：A + B</p>
<p> 操作类型：所有数值类型</p>
<p> 说明：返回A与B相加的结果。结果的数值类型等于A的类型和B的类型的最小父类型（详见数据类型的继承关系）。比如int + int 一般结果为int类型，int + double 一般结果为double类型。</p>
<p> 举例：</p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="number">1</span>+<span class="number">9</span> <span class="keyword">from</span> lxw_dual;</span><br><span class="line">10</span><br><span class="line">hive&gt; <span class="keyword">create</span> table lxw_dual <span class="keyword">as</span> <span class="keyword">select</span> <span class="number">1</span> + <span class="number">1.2</span> <span class="keyword">from</span> lxw_dual;</span><br><span class="line">hive&gt; describe lxw_dual;</span><br><span class="line">_c0     double</span><br></pre></td></tr></table></figure>
</li>
<li><p>减法操作：-</p>
<p> 语法：A - B</p>
<p> 操作类型：所有数值类型</p>
<p> 说明：返回A与B相减的结果。结果的数值类型等于A的类型和B的类型的最小父类型（详见数据类型的继承关系）。比如int - int 一般结果为int类型，int - double 一般结果为double类型。</p>
<p> 举例：</p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="number">10</span><span class="number">-5</span> <span class="keyword">from</span> lxw_dual;</span><br><span class="line">10</span><br><span class="line">hive&gt; <span class="keyword">create</span> table lxw_dual <span class="keyword">as</span> <span class="keyword">select</span> <span class="number">5.6</span> - <span class="number">4</span> <span class="keyword">from</span> lxw_dual;</span><br><span class="line">hive&gt; describe lxw_dual;</span><br><span class="line">_c0     double</span><br></pre></td></tr></table></figure>
</li>
<li><p>乘法操作：*</p>
<p> 语法：A * B</p>
<p> 操作类型：所有数值类型</p>
<p> 说明：返回A与B相乘的结果。结果的数值类型等于A的类型和B的类型的最小父类型（详见数据类型的继承关系），注意，如果A乘以B的结果超过默认结果类型的数值范围，则需要通过cast将结果转换成范围更大的数值类型</p>
<p> 举例：</p>
 <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select <span class="number">40</span> * <span class="number">5</span> from lxw_dual;</span><br><span class="line"><span class="number">200</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>除法操作：/</p>
<p> 语法：A/B</p>
<p> 操作类型：所有数值类型</p>
<p> 说明：返回A除以B的结果，结果数值类型为double</p>
<p> 举例：</p>
 <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select <span class="number">40</span>/<span class="number">5</span> from lxw_dual;</span><br><span class="line"><span class="number">8.0</span></span><br></pre></td></tr></table></figure>
<p> <strong>注意：hive中最高精度的数据类型是double，只精确到小数点后16位，在做除法运算的时候要特别注意</strong></p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">ceil</span>(<span class="number">28.0</span>/<span class="number">6.999999999999999999999</span>) <span class="keyword">from</span> lxw_dual <span class="keyword">limit</span> <span class="number">1</span>;</span><br><span class="line">4</span><br><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">ceil</span>(<span class="number">28.0</span>/<span class="number">6.99999999999999</span>) <span class="keyword">from</span> lxw_dual <span class="keyword">limit</span> <span class="number">1</span>;</span><br><span class="line">5</span><br></pre></td></tr></table></figure>
</li>
<li><p>取余操作：%</p>
<p> 语法：A%B</p>
<p> 操作类型：所有数值类型</p>
<p> 说明：返回A除以B的余数，结果的数值类型等于A的类型和B的类型的最小父类型。</p>
<p> 举例：</p>
 <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select <span class="number">41</span> % <span class="number">5</span> from lxw_dual;</span><br><span class="line"><span class="number">1</span></span><br><span class="line">hive&gt; select <span class="number">8.4</span> % <span class="number">4</span> from lxw_dual;</span><br><span class="line"><span class="number">0.40000000000000036</span></span><br></pre></td></tr></table></figure>
<p> <strong>注意：精度在hive中是个很大的问题，类似这样的问题最好通过round指定精度</strong></p>
 <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select round(<span class="number">8.4</span> % <span class="number">4</span>, <span class="number">2</span>) from lxw_dual;</span><br><span class="line"><span class="number">0.4</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>位与操作：&amp;</p>
<p> 语法：A &amp; B</p>
<p> 操作类型：所有数据类型</p>
<p> 说明：返回A和B按位与操作的结果。结果的数值类型等于A的类型和B的类型的最小父类型。</p>
<p> 举例：</p>
 <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select <span class="number">4</span> &amp; <span class="number">8</span> from lxw_dual;</span><br><span class="line"><span class="number">0</span></span><br><span class="line">hive&gt; select <span class="number">6</span> &amp; <span class="number">4</span> from lxw_dual;</span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>位或操作：|</p>
<p> 语法：A | B</p>
<p> 操作类型：所有数据类型</p>
<p> 说明：返回A和B按位或操作的结果。结果的数值类型等于A的类型和B的类型的最小父类型。</p>
<p> 举例：</p>
 <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select <span class="number">4</span> | <span class="number">8</span> from lxw_dual;</span><br><span class="line"><span class="number">12</span></span><br><span class="line">hive&gt; select <span class="number">6</span> | <span class="number">8</span> from lxw_dual;</span><br><span class="line"><span class="number">14</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>位异或操作：^</p>
<p> 语法：A ^ B</p>
<p> 操作类型：所有数据类型</p>
<p> 说明：返回A和B按位异或操作的结果。结果的数值类型等于A的类型和B的类型的最小父类型。</p>
<p> 举例：</p>
 <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select <span class="number">4</span> ^ <span class="number">8</span> from lxw_dual;</span><br><span class="line"><span class="number">12</span></span><br><span class="line">hive&gt; select <span class="number">6</span> ^ <span class="number">4</span> from lxw_dual;</span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>位取反操作：~</p>
<p> 语法：~A</p>
<p> 操作类型：所有数值类型</p>
<p> 说明：返回A按位取反操作的结果。结果的数值类型等于A的类型。</p>
<p> 举例：</p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> ~<span class="number">6</span> <span class="keyword">from</span> lxw_dual;</span><br><span class="line">-7</span><br><span class="line">hive&gt; <span class="keyword">select</span> ~<span class="number">4</span> <span class="keyword">from</span> lxw_dual;</span><br><span class="line">-5</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="逻辑运算"><a href="#逻辑运算" class="headerlink" title="逻辑运算"></a>逻辑运算</h2><ol>
<li><p>逻辑与操作：AND</p>
<p> 语法：A AND B</p>
<p> 操作类型：boolean</p>
<p> 说明：如果A和B均为TRUE，则为TRUE；否则为False，如果A或B为NULL，则结果是NULL</p>
<p> 举例：</p>
 <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select <span class="number">1</span> from lxw_dual where <span class="number">1</span>=<span class="number">1</span> and <span class="number">2</span>=<span class="number">2</span>;</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>逻辑或操作：OR</p>
<p> 语法：A OR B</p>
<p> 操作类型：boolean</p>
<p> 说明：如果A或B为TRUE，或者A和B都为TRUE，则为TRUE,否则为FALSE</p>
<p> 举例：</p>
 <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select <span class="number">1</span> from lxw_dual where <span class="number">1</span>=<span class="number">1</span> or <span class="number">2</span>=<span class="number">2</span>;</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>逻辑非操作：</p>
<p> 语法：NOT A</p>
<p> 操作类型：boolean</p>
<p> 说明：如果A为Fasle，或A为NULL，则为True，否则为false</p>
<p> 举例：</p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> lxw_dual <span class="keyword">where</span> <span class="keyword">not</span> <span class="number">1</span>=<span class="number">2</span>;</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="数值计算"><a href="#数值计算" class="headerlink" title="数值计算"></a>数值计算</h2><ol>
<li><p>取整函数：round</p>
<p> 语法：round(double a)</p>
<p> 返回值：BIGINT</p>
<p> 说明：返回double类型得整数值部分（四舍五入）</p>
<p> 举例：</p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">round</span>(<span class="number">3.1415926</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">3.0</span><br><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">round</span>(<span class="number">3.5</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">4.0</span><br><span class="line">hive&gt; <span class="keyword">create</span> table lxw_dual <span class="keyword">as</span> <span class="keyword">select</span> <span class="built_in">round</span>(<span class="number">9542.158</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">hive&gt; desc lxw_dual;</span><br><span class="line">_c0     bigint</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定精度取整函数：round</p>
<p> 语法：round(double a, int d)</p>
<p> 返回值：DOUBLE</p>
<p> 说明：返回指定精度d得double类型</p>
<p> 举例：</p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">round</span>(<span class="number">3.1415926</span>,<span class="number">4</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">3.146</span><br></pre></td></tr></table></figure>
</li>
<li><p>向下取整函数：floor</p>
<p> 语法：floor(double a)</p>
<p> 返回值：BIGINT</p>
<p> 说明：返回等于或者小于该double变量得最大得整数</p>
<p> 举例：</p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">floor</span>(<span class="number">3.1415926</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">3</span><br><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">floor</span>(<span class="number">25</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">25</span><br></pre></td></tr></table></figure>
</li>
<li><p>向上取整函数：ceil</p>
<p> 语法：ceil(double a)</p>
<p> 返回值：BIGINT</p>
<p> 说明：返回等于或者大于该double变量得最小整数</p>
<p> 举例：</p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">ceil</span>(<span class="number">3.1415926</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">4</span><br><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">ceil</span>(<span class="number">46</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">46</span><br></pre></td></tr></table></figure>
</li>
<li><p>向上取整函数：ceiling</p>
<p> 语法：ceiling(double a)</p>
<p> 返回值：BIGINT</p>
<p> 说明：与ceil功能相同</p>
<p> 举例：</p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">ceil</span>(<span class="number">3.1415926</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">4</span><br><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">ceil</span>(<span class="number">46</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">46</span><br></pre></td></tr></table></figure>
</li>
<li><p>随机取整函数：rand</p>
<p> 语法：rand();rand(int seed)</p>
<p> 返回值：double</p>
<p> 说明：返回一个0到1范围内的随机数，如果指定种子seed，则返回一个稳定的随机数序列。</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">rand</span>(<span class="params"></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">0.4377351903701565</span></span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">rand</span>(<span class="params"></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">0.5893266433851319</span></span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">rand</span>(<span class="params"><span class="number">100</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">0.7220096548596434</span></span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">rand</span>(<span class="params"><span class="number">100</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">0.7220096548596434</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>自然指数函数：exp</p>
<p> 语法：exp(double a)</p>
<p> 返回值：double</p>
<p> 说明：返回自然数e的a次方</p>
<p> 举例：</p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">exp</span>(<span class="number">2</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">7.38905609893065</span><br></pre></td></tr></table></figure>
<p> 自然对数函数：ln</p>
<p> 语法：ln(double a)</p>
<p> 返回值：double</p>
<p> 说明：返回a的自然对数</p>
<p> 举例：</p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">ln</span>(<span class="number">7.38905609893065</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">2.0</span><br></pre></td></tr></table></figure>
</li>
<li><p>以10为底对数函数：log10</p>
<p> 语法：log10(double a)</p>
<p> 返回值：double</p>
<p> 说明：返回以10为底的a的对数</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hvie&gt; <span class="function"><span class="keyword">select</span> <span class="title">log10</span>(<span class="params"><span class="number">100</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">2.0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>以2为底对数函数：log2</p>
<p> 语法：log2(double a)</p>
<p> 返回值：double</p>
<p> 说明：返回以2为底的a的对数</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hvie&gt; <span class="function"><span class="keyword">select</span> <span class="title">log2</span>(<span class="params"><span class="number">8</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">3.0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>对数函数：log</p>
<p>语法：log(double base, double a)</p>
<p>返回值：double</p>
<p>说明：返回以base为底的a的对数</p>
<p>举例：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hvie&gt; <span class="keyword">select</span> <span class="built_in">log</span>(<span class="number">4</span>, <span class="number">256</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">4.0</span><br></pre></td></tr></table></figure>
</li>
<li><p>幂运算函数：pow</p>
<p>语法:pow(double a, double p)</p>
<p>返回值：double</p>
<p>说明：返回a的p次幂</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">pow</span>(<span class="params"><span class="number">2</span>, <span class="number">4</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">16.0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>幂运算函数：power</p>
<p>语法:power(double a, double p)</p>
<p>返回值：double</p>
<p>说明：返回a的p次幂，与pow功能相同</p>
<p>举例：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">power</span>(<span class="number">2</span>, <span class="number">4</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">16.0</span><br></pre></td></tr></table></figure>
</li>
<li><p>开方函数：sqrt</p>
<p>语法：sqrt(double a)</p>
<p>返回值：double</p>
<p>说明：返回a的平方根</p>
<p>举例：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">sqrt</span>(<span class="number">16</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">4.0</span><br></pre></td></tr></table></figure>
</li>
<li><p>二进制函数：bin</p>
<p>语法：bin(BIGINT a)</p>
<p>返回值：string</p>
<p>说明：返回a的二进制代码表示</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">bin</span>(<span class="params"><span class="number">7</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">111</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>十六进制函数：hex</p>
<p>语法：hex(BIGINT a)</p>
<p>返回值：string</p>
<p>说明：如果变量是int类型，那么返回a的十六进制表示，如果变量是string类型，则返回该字符串的十六进制表示。</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">bin</span>(<span class="params"><span class="number">17</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">11</span></span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">hex</span>(<span class="params"><span class="string">'abc'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">616263</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>反转十六进制函数：unhex</p>
<p>语法：unhex(BIGINT a)</p>
<p>返回值：string</p>
<p>说明：返回该十六进制字符串所代表的字符串</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">unhex</span>(<span class="params"><span class="string">'616263'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">abc</span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">unhex</span>(<span class="params"><span class="string">'111'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">-</span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">unhex</span>(<span class="params"><span class="number">616263</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">abc</span><br></pre></td></tr></table></figure>
</li>
<li><p>进制转换函数：conv</p>
<p>语法：conv(bigint num, int from_base, int to_base)</p>
<p>返回值：string</p>
<p>说明：将数值num从from_base进制转化到to_base进制。</p>
<p>举例：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select conv(<span class="number">17</span>, <span class="number">10</span>, <span class="number">16</span>) from lxw_dual;</span><br><span class="line"><span class="number">11</span></span><br><span class="line">hive&gt; select conv(<span class="number">17</span>, <span class="number">10</span>, <span class="number">2</span>) from lxw_dual;</span><br><span class="line"><span class="number">10001</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>绝对值函数：abs</p>
<p>语法：abs(double a) abs(int a)</p>
<p>返回值：double int</p>
<p>说明：返回数值a的绝对值</p>
<p>举例：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">abs</span>(<span class="number">-3.9</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">3.9</span><br><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">abs</span>(<span class="number">10.9</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">10.<span class="number">9</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>正取余函数：pmod</p>
<p>语法：pmod(int a, int b), pmod(double a, double b)</p>
<p>返回值：int double</p>
<p>说明：返回正的a除以b的余数</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">pmod</span>(<span class="params"><span class="number">9</span>, <span class="number">4</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">1</span></span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">pmod</span>(<span class="params"><span class="number">-9</span>, <span class="number">4</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>正弦函数：sin</p>
<p>语法：sin(double a)</p>
<p>返回值：double</p>
<p>说明：返回a的正弦值</p>
<p>举例：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">sin</span>(<span class="number">0.8</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">0.7173560908995228</span><br></pre></td></tr></table></figure>
</li>
<li><p>反正弦函数：asin</p>
<p>语法：asin(double a)</p>
<p>返回值：double</p>
<p>说明：返回a的反正弦值</p>
<p>举例：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">asin</span>(<span class="number">0.7173560908995228</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">0.8</span><br></pre></td></tr></table></figure>
</li>
<li><p>正弦函数：cos</p>
<p>语法：cos(double a)</p>
<p>返回值：double</p>
<p>说明：返回a的余弦值</p>
<p>举例：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">cos</span>(<span class="number">0.9</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">0.6216099682706644</span><br></pre></td></tr></table></figure>
</li>
<li><p>反正弦函数：acos</p>
<p>语法：acos(double a)</p>
<p>返回值：double</p>
<p>说明：返回a的反余弦值</p>
<p>举例：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">acos</span>(<span class="number">0.6216099682706644</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">0.9</span><br></pre></td></tr></table></figure>
</li>
<li><p>positive函数：positive</p>
<p>语法：positive(int a), positive(double a)</p>
<p>返回值：int， double</p>
<p>说明：返回a</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">positive</span>(<span class="params"><span class="number">-10</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">-10</span></span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">positive</span>(<span class="params"><span class="number">12</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>negative函数：negative</p>
<p>语法：negative(int a), negative(double a)</p>
<p>返回值：int， double</p>
<p>说明：返回-a</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">negative</span>(<span class="params"><span class="number">-5</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">5</span></span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">negative</span>(<span class="params"><span class="number">8</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">-8</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="日期函数"><a href="#日期函数" class="headerlink" title="日期函数"></a>日期函数</h2><ol>
<li><p>UNIX时间戳转日期函数：from_unixtime</p>
<p> 语法：from_unixtime(bigint unixtime[, string format])</p>
<p> 返回值：string</p>
<p> 说明：转化UNIX时间戳（从1970-01-01 00：00：00 UTC到指定时间的秒数）到当前时区的时间格式</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">from_unixtime</span>(<span class="params"><span class="number">1323308943</span>, <span class="string">'yyyyMMdd'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">20111208</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>获取当前UNIX时间戳函数：unix_timestamp</p>
<p> 语法：unix_timestamp()</p>
<p> 返回值：bigint</p>
<p> 说明：获得当前时区的UNIX时间戳</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">unix_timestamp</span>(<span class="params"></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">1546673672</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>日志转UNIX时间戳函数：unix_timestamp</p>
<p> 语法：unix_timestamp(string data)</p>
<p> 返回值：bigint</p>
<p> 说明：转换格式为”yyyy-MM-dd HH:mm:ss“的日期到UNIX时间戳。如果转化失败，返回0.</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">unix_timestamp</span>(<span class="params"><span class="string">'2011-12-07 13:01:03'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">1323234063</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>指定格式日期转换UNIX时间戳函数：unix_timestamp</p>
<p> 语法：unix_timestamp(string date, string pattern)</p>
<p> 返回值：bigint</p>
<p> 说明：转换pattern格式的日期到UNIX时间戳。如果转化失败，则返回0</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">unix_timestamp</span>(<span class="params"><span class="string">'20111207 13:01:03'</span>, <span class="string">'yyyyMMdd HH:mm:ss'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">1323234063</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>日期时间转日期函数：to_date</p>
<p> 语法：to_date(string timestamp)</p>
<p> 返回值：string</p>
<p> 说明：返回日期时间字段中的日期部分。</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">to_date</span>(<span class="params"><span class="string">'2011-12-08 10:03:01'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">2011</span><span class="number">-12</span><span class="number">-08</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>日期时间转年函数：year</p>
<p> 语法：year(string date)</p>
<p> 返回值：int</p>
<p> 说明：返回日期中的年。</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">year</span>(<span class="params"><span class="string">'2011-12-08 10:03:01'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">2011</span></span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">year</span>(<span class="params"><span class="string">'2012-12-08'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">2012</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>日期转年函数：month</p>
<p> 语法：month(string date)</p>
<p> 返回值：int</p>
<p> 说明：返回日期中的月。</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">month</span>(<span class="params"><span class="string">'2011-12-08 10:03:01'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">12</span></span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">month</span>(<span class="params"><span class="string">'2012-12-08'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>日期转天函数：day</p>
<p> 语法：day(string date)</p>
<p> 返回值：int</p>
<p> 说明：返回日期中的天。</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">day</span>(<span class="params"><span class="string">'2011-12-08 10:03:01'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">8</span></span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">day</span>(<span class="params"><span class="string">'2012-12-24'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">24</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>日期转小时函数：hour</p>
<p> 语法：hour(string date)</p>
<p> 返回值：int</p>
<p> 说明：返回日期中的小时。</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">hour</span>(<span class="params"><span class="string">'2011-12-08 10:03:01'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">10</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>日期转分钟函数：minite</p>
<p>语法：minite(string date)</p>
<p>返回值：int</p>
<p>说明：返回日期中的分钟。</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">minite</span>(<span class="params"><span class="string">'2011-12-08 10:03:01'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>日期转秒函数：second</p>
<p>语法：second(string date)</p>
<p>返回值：int</p>
<p>说明：返回日期中的秒。</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">second</span>(<span class="params"><span class="string">'2011-12-08 10:03:01'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>日期转周函数：weekofyear</p>
<p>语法：weekofyear(string date)</p>
<p>返回值：int</p>
<p>说明：返回日期在当前的周。</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">weekofyear</span>(<span class="params"><span class="string">'2011-12-08 10:03:01'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">49</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>日期比较函数：datediff</p>
<p>语法：datediff(string enddate, string startdate)</p>
<p>返回值：int</p>
<p>说明：返回结束日期减去开始日期的天数。</p>
<p>举例：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select datediff('<span class="number">2012</span><span class="number">-12</span><span class="number">-08</span>', '<span class="number">2012</span><span class="number">-05</span><span class="number">-09</span>') from lxw_dual;</span><br><span class="line"><span class="number">213</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>日期增加函数：date_add</p>
<p>语法：date_add(string startdate, int days)</p>
<p>返回值：string</p>
<p>说明：返回开始日期stardate增加days天后的日期。</p>
<p>举例：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select date_add('<span class="number">2012</span><span class="number">-12</span><span class="number">-08</span>', <span class="number">10</span>) from lxw_dual;</span><br><span class="line"><span class="number">2012</span><span class="number">-12</span><span class="number">-18</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>日期减少函数：date_sub</p>
<p>语法：date_sub(string startdate, int days)</p>
<p>返回值：string</p>
<p>说明：返回开始日期stardate减少days天后的日期。</p>
<p>举例：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select date_sub('<span class="number">2012</span><span class="number">-12</span><span class="number">-08</span>', <span class="number">10</span>) from lxw_dual;</span><br><span class="line"><span class="number">2012</span><span class="number">-11</span><span class="number">-28</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="条件函数"><a href="#条件函数" class="headerlink" title="条件函数"></a>条件函数</h2><ol>
<li><p>if函数：if</p>
<p> 语法：if(boolean testCondition, T valueTrue, T valueFalseOrNull)</p>
<p> 返回值：T</p>
<p> 说明：当条件testCondition为True时，返回valueTrue，否则返回valueFalseOrNull</p>
<p> 举例：</p>
 <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select if(<span class="number">1</span>=<span class="number">2</span>, <span class="number">100</span>, <span class="number">200</span>) from lxw_dual;</span><br><span class="line"><span class="number">200</span></span><br><span class="line">hive&gt; select if(<span class="number">1</span>=<span class="number">1</span>, <span class="number">100</span>, <span class="number">200</span>) from lxw_dual;</span><br><span class="line"><span class="number">100</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>非空查找函数：COALESCE</p>
<p> 语法：COALESCE(T v1, T v2, …)</p>
<p> 返回值：T</p>
<p> 说明：返回参数中的第一个非空值，如果所有值都为NULL，那么返回NULL</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">COALESCE</span>(<span class="params"><span class="literal">null</span>, <span class="string">'100'</span>, <span class="string">'50'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">100</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>条件判断函数：CASE</p>
<p> 语法：CASE a WHEN b THEN c [WHEN d THEN e] [ELSE f] END</p>
<p> 返回值：T</p>
<p> 说明：如果a等于b，那么返回c，如果a等于d，那么返回e，否则返回f</p>
<p> 举例：</p>
 <figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="keyword">case</span> <span class="number">100</span> <span class="keyword">when</span> <span class="number">50</span> <span class="keyword">then</span> <span class="symbol">'tom</span>' <span class="keyword">when</span> <span class="number">100</span> <span class="keyword">then</span> <span class="symbol">'mary</span>' <span class="keyword">else</span> <span class="symbol">'tim</span>' <span class="keyword">end</span> from lxw_dual;</span><br><span class="line">mary</span><br><span class="line">hive&gt; <span class="keyword">select</span> <span class="keyword">case</span> <span class="number">200</span> <span class="keyword">when</span> <span class="number">50</span> <span class="keyword">then</span> <span class="symbol">'tom</span>' <span class="keyword">when</span> <span class="number">100</span> <span class="keyword">then</span> <span class="symbol">'mary</span>' <span class="keyword">else</span> <span class="symbol">'tim</span>' <span class="keyword">end</span> from lxw_dual;</span><br><span class="line">tim</span><br></pre></td></tr></table></figure>
</li>
<li><p>条件判断函数：CASE</p>
<p> 语法：CASE WHEN a THEN b [WHEN c THEN d] [ELSE e] END</p>
<p> 返回值：T</p>
<p> 说明：如果a为True，则返回b；如果c为True，返回d，否则返回e</p>
<p> 举例：</p>
 <figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="keyword">case</span> <span class="keyword">when</span> <span class="number">1</span>=<span class="number">2</span> <span class="keyword">then</span> <span class="symbol">'tom</span>' <span class="keyword">when</span> <span class="number">2</span>=<span class="number">2</span> <span class="keyword">then</span> <span class="symbol">'mary</span>' <span class="keyword">else</span> <span class="symbol">'tim</span>' <span class="keyword">end</span> from lxw_dual;</span><br><span class="line">mary</span><br><span class="line">hive&gt; <span class="keyword">select</span> <span class="keyword">case</span> <span class="keyword">when</span> <span class="number">1</span>=<span class="number">1</span> <span class="keyword">then</span> <span class="symbol">'tom</span>' <span class="keyword">when</span> <span class="number">2</span>=<span class="number">2</span> <span class="keyword">then</span> <span class="symbol">'mary</span>' <span class="keyword">else</span> <span class="symbol">'tim</span>' <span class="keyword">end</span> from lxw_dual;</span><br><span class="line">tom</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h2><ol>
<li><p>字符串长度函数：length</p>
<p> 语法：length(string A)</p>
<p> 返回值：int</p>
<p> 说明：返回字符串A的长度</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">length</span>(<span class="params"><span class="string">'abcdefg'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">7</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>字符串反转函数：reverse</p>
<p> 语法:reverse(string a)</p>
<p> 返回值：string</p>
<p> 说明：返回字符串A的反转结果</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">reverse</span>(<span class="params"><span class="string">'abcdefg'</span></span>) <span class="keyword">from</span> lxw_dual</span>; </span><br><span class="line">gfedcba</span><br></pre></td></tr></table></figure>
</li>
<li><p>字符串连接函数：concat</p>
<p> 语法：concat(string a, string b …)</p>
<p> 返回值：string</p>
<p> 说明：返回输入字符串连接后的结果，支持任意个输入字符串</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">concat</span>(<span class="params"><span class="string">'abc'</span>, <span class="string">'def'</span>, <span class="string">'gh'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">abcdefgh</span><br></pre></td></tr></table></figure>
</li>
<li><p>带分隔符字符串连接函数：concat_ws</p>
<p> 语法：concat_ws(string sep, string a, string b …)</p>
<p> 返回值：string</p>
<p> 说明：返回输入字符串连接后的结果，sep表示各个字符间的分隔符</p>
<p> 举例：</p>
 <figure class="highlight flix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select concat_ws(<span class="string">'-'</span>, 'abc', '<span class="function"><span class="keyword">def</span>', '<span class="title">gh</span>') <span class="title">from</span> <span class="title">lxw_dual</span></span>;</span><br><span class="line">abc-<span class="function"><span class="keyword">def</span><span class="title">-gh</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>字符串截取函数：substr, substring</p>
<p> 语法：substr(string a, int start), substring(string a, int start)</p>
<p> 返回值：string</p>
<p> 说明：返回字符串a从start位置到结尾的字符串</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">substr</span>(<span class="params"><span class="string">'abcde'</span>, <span class="number">3</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">cde</span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">substring</span>(<span class="params"><span class="string">'abcde'</span>, <span class="number">3</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">cde</span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">substr</span>(<span class="params"><span class="string">'abcde'</span>, <span class="number">-1</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">e</span><br></pre></td></tr></table></figure>
</li>
<li><p>字符串截取函数：substr, substring</p>
<p> 语法：substr(string a, int start, int len), substring(string a, int start, int len)</p>
<p> 返回值：string</p>
<p> 说明：返回字符串a从start位置开始，长度为len的字符串</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">substr</span>(<span class="params"><span class="string">'abcde'</span>, <span class="number">3</span>, <span class="number">2</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">cd</span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">substring</span>(<span class="params"><span class="string">'abcde'</span>, <span class="number">3</span>, <span class="number">2</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">de</span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">substring</span>(<span class="params"><span class="string">'abcde'</span>, <span class="number">-2</span>, <span class="number">2</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">de</span><br></pre></td></tr></table></figure>
</li>
<li><p>字符串转大写函数：upper, ucase</p>
<p>语法：upper(string a), ucase(string a)</p>
<p>返回值：string</p>
<p>说明：返回字符串a的大写格式</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">upper</span>(<span class="params"><span class="string">'abcDe'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">ABCDE</span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">ucase</span>(<span class="params"><span class="string">'abcDe'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">ABCDE</span><br></pre></td></tr></table></figure>
</li>
<li><p>字符串转小写函数：lower, lcase</p>
<p> 语法：lower(string a), lcase(string a)</p>
<p> 返回值：string</p>
<p> 说明：返回字符串a的小写格式</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">lower</span>(<span class="params"><span class="string">'abcDe'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">abcde</span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">lcase</span>(<span class="params"><span class="string">'abcDe'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">abcde</span><br></pre></td></tr></table></figure>
</li>
<li><p>去除空格函数：trim</p>
<p> 语法：trim(string a)</p>
<p> 返回值：string</p>
<p> 说明：去除字符串两边的空格</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">trim</span>(<span class="params"><span class="string">' abc '</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">abc</span><br></pre></td></tr></table></figure>
</li>
<li><p>去除左边空格函数：ltrim</p>
<p>语法：ltrim(string a)</p>
<p>返回值：string</p>
<p>说明：去除字符串左边的空格</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">ltrim</span>(<span class="params"><span class="string">' abc '</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">abc</span><br></pre></td></tr></table></figure>
</li>
<li><p>去除右边空格函数：rtrim</p>
<p>语法：rtrim(string a)</p>
<p>返回值：string</p>
<p>说明：去除字符串右边的空格</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">rtrim</span>(<span class="params"><span class="string">' abc '</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"> abc</span><br></pre></td></tr></table></figure>
</li>
<li><p>正则表达式替换函数：regexp_replace</p>
<p>语法：regexp_place(string a, string b, string c)</p>
<p>返回值：string</p>
<p>说明：将字符串a中的符合java正则表达式b的部分替换成c，注意，在有些情况下要使用转义字符，类似oracle中的regexp_replace函数。</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">regexp_replace</span>(<span class="params"><span class="string">'foobar'</span>, <span class="string">'oo|ar'</span>, <span class="string">''</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">fb</span><br></pre></td></tr></table></figure>
</li>
<li><p>正则表达式解析函数：regexp_extract</p>
<p>语法：regexp_extract(string subject, string pattern, int index)</p>
<p>返回值：string</p>
<p>说明：将字符串subject按照pattern正则表达式的规则拆分，返回index指定的字符。</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">regexp_extract</span>(<span class="params"><span class="string">'foothebar'</span>, <span class="string">'foo(.*?)(bar)'</span>, <span class="number">1</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">the</span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">regexp_extract</span>(<span class="params"><span class="string">'foothebar'</span>, <span class="string">'foo(.*?)(bar)'</span>, <span class="number">2</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">bar</span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">regexp_extract</span>(<span class="params"><span class="string">'foothebar'</span>, <span class="string">'foo(.*?)(bar)'</span>, <span class="number">0</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">foothebar</span><br></pre></td></tr></table></figure>
<p><strong>注意，在有些情况下要使用转义字符，下面的等号要用双竖线转义，这是java正则表达式的规则</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> data_field,</span><br><span class="line">regexp_extract(data_field, <span class="string">'.*?bgStart\\=([^&amp;+])'</span>, <span class="number">1</span>) <span class="keyword">as</span> aaa,</span><br><span class="line">regexp_extract(data_field, <span class="string">'.*?contentLoaded_headStart\\=([^&amp;+])'</span>, <span class="number">1</span>) <span class="keyword">as</span> bbb</span><br><span class="line"><span class="keyword">from</span> pt_nginx_loginlog_st</span><br><span class="line"><span class="keyword">where</span> pt=<span class="string">'2012-03-26'</span> <span class="keyword">limit</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>URL解析函数：parse_url</p>
<p>语法：parse_url(string urlString, string partToExtract [, string keyToExtract])</p>
<p>返回值：string</p>
<p>说明：返回URL中指定的部分。parToExtract的有效值为：HOST，PORT，QUERY，REF，PROTOCOL，AUTHORITY，FILE，USERINFO</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">parse_url</span>(<span class="params"><span class="string">'http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1'</span>, <span class="string">'HOST'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">facebook.com</span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">parse_url</span>(<span class="params"><span class="string">'http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1'</span>, <span class="string">'QUERY'</span>, <span class="string">'k1'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">v1</span><br></pre></td></tr></table></figure>
</li>
<li><p>json解析函数：get_json_object</p>
<p>语法：get_json_object(string json_string, string path)</p>
<p>返回值：string</p>
<p>说明：解析json的字符串json_string，返回path指定的内容。如果输入的json字符串无效，则返回null。</p>
<p>举例：</p>
<figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> get_json_object(<span class="string">'&#123;"</span>store<span class="string">":"</span>hehe<span class="string">", "</span>owner<span class="string">" : "</span>amy<span class="string">"&#125;'</span>, <span class="string">'$.owner'</span>) from lxw_dual;</span><br><span class="line">amy</span><br></pre></td></tr></table></figure>
</li>
<li><p>空格字符串space</p>
<p>语法：space(int n)</p>
<p>返回值：string</p>
<p>说明：返回长度为n的字符串</p>
<p>举例：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> space(<span class="number">10</span>) <span class="keyword">from</span> lxw_dual;</span><br><span class="line"></span><br><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">length</span>(space(<span class="number">10</span>)) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">10</span><br></pre></td></tr></table></figure>
</li>
<li><p>重复字符串函数：repeat</p>
<p>语法：repeat(string str, int n)</p>
<p>返回值：string</p>
<p>说明：返回重复n次后的str字符串</p>
<p>举例:</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">repeat</span>(<span class="params"><span class="string">'abc'</span>, <span class="number">5</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">abcabcabcabcabc</span><br></pre></td></tr></table></figure>
</li>
<li><p>首字符ascii函数：ascii</p>
<p>语法：ascii(string str)</p>
<p>返回值：int</p>
<p>说明：返回字符串str的第一个字符的ascii码</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">ascii</span>(<span class="params"><span class="string">'abc'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">97</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>左补足函数：lpad</p>
<p>语法：lpad(string str, int len, string pad)</p>
<p>返回值：string</p>
<p>说明：将str进行用pad进行左补足到len位</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">lpad</span>(<span class="params"><span class="string">'abc'</span>, <span class="number">10</span>, <span class="string">'td'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">tdtdtdtabc</span><br></pre></td></tr></table></figure>
<p><strong>注意，与GP，ORACLE不同，pad不能默认</strong></p>
</li>
<li><p>右补足函数：rpad</p>
<p>语法：rpad(string str, int len, string pad)</p>
<p>返回值：string</p>
<p>说明：将str进行用pad进行右补足到len位</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">rpad</span>(<span class="params"><span class="string">'abc'</span>, <span class="number">10</span>, <span class="string">'td'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">abctdtdtdt</span><br></pre></td></tr></table></figure>
</li>
<li><p>分割字符串函数：split</p>
<p>语法：split(string str, string pat)</p>
<p>返回值：array</p>
<p>说明：按照pat字符串分割str，会返回分割后的字符串数组</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">split</span>(<span class="params"><span class="string">'abtcdted'</span>, <span class="string">'t'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">[<span class="meta"><span class="meta-string">"ab"</span>,<span class="meta-string">"cd"</span>,<span class="meta-string">"ed"</span></span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>集合查找函数：find_in_set</p>
<p>语法：find_in_set(string str, string strList)</p>
<p>返回值：int</p>
<p>说明：返回str在strList第一次出现的位置，strList是用逗号分割的字符串。如果没有找到就返回0.</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">find_in_set</span>(<span class="params"><span class="string">'ab'</span>, <span class="string">'ef,ab,de'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">2</span></span><br><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">find_in_set</span>(<span class="params"><span class="string">'at'</span>, <span class="string">'ef,ab,de'</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="集合统计函数"><a href="#集合统计函数" class="headerlink" title="集合统计函数"></a>集合统计函数</h2><ol>
<li><p>个数统计函数: count</p>
<p> 语法: count(*), count(expr), count(DISTINCT expr[, expr_.])</p>
<p> 返回值: int</p>
<p> 说明: count(*)统计检索出的行的个数，包括 NULL 值的行；count(expr)返回指定字段的非空值的个数；count(DISTINCT expr[, expr_.])返回指定字段的不同的非空值的个数</p>
<p> 举例：</p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">count</span>(*) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">20</span><br><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> t) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">10</span><br></pre></td></tr></table></figure>
</li>
<li><p>总和统计 函数: sum</p>
<p>语法: sum(col), sum(DISTINCT col)</p>
<p>返回值: double</p>
<p>说明: sum(col)统计结果集中 col 的相加的结果；sum(DISTINCT col)统计结果中 col 不同值相加的结果</p>
<p>举例：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">sum</span>(t) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">100</span><br><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">sum</span>(<span class="keyword">distinct</span> t) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">70</span><br></pre></td></tr></table></figure>
</li>
<li><p>平均值统计函数: avg</p>
<p>语法: avg(col), avg(DISTINCT col)</p>
<p>返回值: double</p>
<p>说明: avg(col)统计结果集中 col 的平均值；avg(DISTINCT col)统计结果中 col 不同值相加的平均值</p>
<p>举例：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">avg</span>(t) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">50</span><br><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">avg</span> (<span class="keyword">distinct</span> t) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">30</span><br></pre></td></tr></table></figure>
</li>
<li><p>最小值统计函数: min</p>
<p>语法: min(col)</p>
<p>返回值: double</p>
<p>说明: 统计结果集中 col 字段的最小值</p>
<p>举例：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">min</span>(t) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">20</span><br></pre></td></tr></table></figure>
</li>
<li><p>最大值统计函数: max</p>
<p>语法: max(col)</p>
<p>返回值: double</p>
<p>说明: 统计结果集中 col 字段的最大值</p>
<p>举例：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="built_in">max</span>(t) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">120</span><br></pre></td></tr></table></figure>
</li>
<li><p>非空集合总体变量函数: var_pop</p>
<p>语法: var_pop(col)</p>
<p>返回值: double</p>
<p>说明: 统计结果集中 col 非空集合的总体变量（忽略 null）</p>
</li>
</ol>
<ol start="7">
<li><p>非空集合样本变量函数: var_samp</p>
<p>语法: var_samp (col)</p>
<p>返回值: double</p>
<p>说明: 统计结果集中 col 非空集合的样本变量（忽略 null）</p>
</li>
<li><p>总体标准偏离函数: stddev_pop</p>
<p>语法: stddev_pop(col)</p>
<p>返回值: double</p>
<p>说明: 该函数计算总体标准偏离，并返回总体变量的平方根，其返回值与 VAR_POP 函数的平方根相同</p>
<p>举例：</p>
</li>
<li><p>样本标准偏离函数: stddev_samp</p>
<p>语法: stddev_samp (col)</p>
<p>返回值: double</p>
<p>说明: 该函数计算样本标准偏离</p>
<p>举例：</p>
</li>
<li><p>中位数函数: percentile</p>
<p>语法: percentile(BIGINT col, p)</p>
<p>返回值: double</p>
<p>说明: 求准确的第 pth 个百分位数，p 必须介于 0 和 1 之间，但是 col 字段目前只支持整数，不支持浮点数类型</p>
<p>举例：</p>
</li>
<li><p>中位数函数: percentile</p>
<p>语法: percentile(BIGINT col, array(p1 [, p2]…))</p>
<p>返回值: array<double></double></p>
<p>说明: 功能和上述类似，之后后面可以输入多个百分位数，返回类型也为 array<double>，其中为对应的百分位数。</double></p>
<p>举例：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">select</span> <span class="selector-tag">percentile</span>(<span class="selector-tag">score</span>,&lt;0<span class="selector-class">.2</span>,0<span class="selector-class">.4</span>&gt;) <span class="selector-tag">from</span> <span class="selector-tag">lxw_dual</span>； 取 0<span class="selector-class">.2</span>，0<span class="selector-class">.4</span> 位置的数据</span><br></pre></td></tr></table></figure>
</li>
<li><p>近似中位数函数: percentile_approx</p>
<p>语法: percentile_approx(DOUBLE col, p [, B])</p>
<p>返回值: double</p>
<p>说明: 求近似的第 pth 个百分位数，p 必须介于 0 和 1 之间，返回类型为 double，但是col 字段支持浮点类型。参数 B 控制内存消耗的近似精度，B 越大，结果的准确度越高。默认为 10,000。当 col 字段中的 distinct 值的个数小于 B 时，结果为准确的百分位数</p>
<p>举例：</p>
</li>
<li><p>近似中位数函数: percentile_approx</p>
<p>语法: percentile_approx(DOUBLE col, array(p1 [, p2]…) [, B])</p>
<p>返回值: array<double></double></p>
<p>说明: 功能和上述类似，之后后面可以输入多个百分位数，返回类型也为 array<double>，其中为对应的百分位数。</double></p>
<p>举例：</p>
</li>
<li><p>直方图: histogram_numeric</p>
<p>语法: histogram_numeric(col, b)</p>
<p>返回值: array<struct {‘x’,‘y’}></struct></p>
<p>说明: 以 b 为基准计算 col 的直方图信息。</p>
<p>举例：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">histogram_numeric</span>(<span class="params"><span class="number">100</span>,<span class="number">5</span></span>) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">[<span class="meta">&#123;<span class="meta-string">"x"</span>:100.0,<span class="meta-string">"y"</span>:1.0&#125;</span>]</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="复合类型构建函数"><a href="#复合类型构建函数" class="headerlink" title="复合类型构建函数"></a>复合类型构建函数</h2><ol>
<li><p>Map  类型构建: map</p>
<p> 语法: map (key1, value1, key2, value2, …)</p>
<p> 说明：根据输入的 key 和 value 对构建 map 类型</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function">Create table lxw_test <span class="keyword">as</span> <span class="keyword">select</span> <span class="title">map</span>(<span class="params"><span class="string">'100'</span>,<span class="string">'tom'</span>,<span class="string">'200'</span>,<span class="string">'mary'</span></span>) <span class="keyword">as</span> t <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">hive&gt; describe lxw_test;</span><br><span class="line">t map&lt;<span class="keyword">string</span>,<span class="keyword">string</span>&gt;</span><br><span class="line">hive&gt; <span class="keyword">select</span> t <span class="keyword">from</span> lxw_test;</span><br><span class="line">&#123;<span class="string">"100"</span>:<span class="string">"tom"</span>,<span class="string">"200"</span>:<span class="string">"mary"</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Struct  类型构建: struct</p>
<p> 语法: struct(val1, val2, val3, …)</p>
<p> 说明：根据输入的参数构建结构体 struct 类型</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function">create table lxw_test <span class="keyword">as</span> <span class="keyword">select</span> <span class="title">struct</span>(<span class="params"><span class="string">'tom'</span>,<span class="string">'mary'</span>,<span class="string">'tim'</span></span>) <span class="keyword">as</span> t <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">hive&gt; describe lxw_test;</span><br><span class="line">t <span class="keyword">struct</span>&lt;col1:<span class="keyword">string</span>,col2:<span class="keyword">string</span>,col3:<span class="keyword">string</span>&gt;</span><br><span class="line">hive&gt; <span class="keyword">select</span> t <span class="keyword">from</span> lxw_test;</span><br><span class="line">&#123;<span class="string">"col1"</span>:<span class="string">"tom"</span>,<span class="string">"col2"</span>:<span class="string">"mary"</span>,<span class="string">"col3"</span>:<span class="string">"tim"</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>array  类型构建: array</p>
<p> 语法: array(val1, val2, …)</p>
<p> 说明：根据输入的参数构建数组 array 类型</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function">create table lxw_test <span class="keyword">as</span> <span class="keyword">select</span> <span class="title">array</span>(<span class="params"><span class="string">"tom"</span>,<span class="string">"mary"</span>,<span class="string">"tim"</span></span>) <span class="keyword">as</span> t <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">hive&gt; describe lxw_test;</span><br><span class="line">t array&lt;<span class="keyword">string</span>&gt;</span><br><span class="line">hive&gt; <span class="keyword">select</span> t <span class="keyword">from</span> lxw_test;</span><br><span class="line">[<span class="meta"><span class="meta-string">"tom"</span>,<span class="meta-string">"mary"</span>,<span class="meta-string">"tim"</span></span>]</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="复杂类型访问操作"><a href="#复杂类型访问操作" class="headerlink" title="复杂类型访问操作"></a>复杂类型访问操作</h2><ol>
<li><p>array  类型访问: A[n]</p>
<p> 语法: A[n]</p>
<p> 操作类型: A 为 array 类型，n 为 int 类型</p>
<p> 说明：返回数组 A 中的第 n 个变量值。数组的起始下标为 0。比如，A 是个值为[‘foo’, ‘bar’]的数组类型，那么 A[0]将返回’foo’,而 A[1]将返回’bar’</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function">create table lxw_test <span class="keyword">as</span> <span class="keyword">select</span> <span class="title">array</span>(<span class="params"><span class="string">"tom"</span>,<span class="string">"mary"</span>,<span class="string">"tim"</span></span>) <span class="keyword">as</span> t <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">hive&gt; <span class="keyword">select</span> t[<span class="number">0</span>],t[<span class="number">1</span>],t[<span class="number">2</span>] <span class="keyword">from</span> lxw_test;</span><br><span class="line">tom mary tim</span><br></pre></td></tr></table></figure>
</li>
<li><p>map  类型访问: M[key]</p>
<p> 语法: M[key]</p>
<p> 操作类型: M 为 map 类型，key 为 map 中的 key 值</p>
<p> 说明：返回 map 类型 M 中，key 值为指定值的 value 值。比如，M 是值为{‘f’ -&gt; ‘foo’, ‘b’-&gt; ‘bar’, ‘all’ -&gt; ‘foobar’}的 map 类型，那么 M[‘all’]将会返回’foobar’</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function">Create table lxw_test <span class="keyword">as</span> <span class="keyword">select</span> <span class="title">map</span>(<span class="params"><span class="string">'100'</span>,<span class="string">'tom'</span>,<span class="string">'200'</span>,<span class="string">'mary'</span></span>) <span class="keyword">as</span> t <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">hive&gt; <span class="keyword">select</span> t[<span class="string">'200'</span>],t[<span class="string">'100'</span>] <span class="keyword">from</span> lxw_test;</span><br><span class="line">mary tom</span><br></pre></td></tr></table></figure>
</li>
<li><p>struct  类型访问: S.x</p>
<p> 语法: S.x</p>
<p> 操作类型: S 为 struct 类型</p>
<p> 说明：返回结构体 S 中的 x 字段。比如，对于结构体 struct foobar {int foo, int bar}，foobar.foo 返回结构体中的 foo 字段</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function">create table lxw_test <span class="keyword">as</span> <span class="keyword">select</span> <span class="title">struct</span>(<span class="params"><span class="string">'tom'</span>,<span class="string">'mary'</span>,<span class="string">'tim'</span></span>) <span class="keyword">as</span> t <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line">hive&gt; describe lxw_test;</span><br><span class="line">t <span class="keyword">struct</span>&lt;col1:<span class="keyword">string</span>,col2:<span class="keyword">string</span>,col3:<span class="keyword">string</span>&gt;</span><br><span class="line">hive&gt; <span class="keyword">select</span> t.col1,t.col3 <span class="keyword">from</span> lxw_test;</span><br><span class="line">tom tim</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="复杂类型长度统计函数"><a href="#复杂类型长度统计函数" class="headerlink" title="复杂类型长度统计函数"></a>复杂类型长度统计函数</h2><ol>
<li><p>Map  类型长度函数: size(Map&lt;K.V&gt;)</p>
<p> 语法: size(Map&lt;K.V&gt;)</p>
<p> 返回值: int</p>
<p> 说明: 返回 map 类型的长度</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">size</span>(<span class="params">map(<span class="string">'100'</span>,<span class="string">'tom'</span>,<span class="string">'101'</span>,<span class="string">'mary'</span></span>)) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>array  类型长度函数: size(Array<t>)</t></p>
<p> 语法: size(Array<t>)</t></p>
<p> 返回值: int</p>
<p> 说明: 返回 array 类型的长度</p>
<p> 举例：</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="function"><span class="keyword">select</span> <span class="title">size</span>(<span class="params">array(<span class="string">'100'</span>,<span class="string">'101'</span>,<span class="string">'102'</span>,<span class="string">'103'</span></span>)) <span class="keyword">from</span> lxw_dual</span>;</span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>类型转换函数: cast</p>
<p> 语法: cast(expr as <type>)</type></p>
<p> 返回值: Expected “=” to follow “type”</p>
<p> 说明: 返回 array 类型的长度</p>
<p> 举例：</p>
 <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="keyword">select</span> <span class="keyword">cast</span>(<span class="number">1</span> <span class="keyword">as</span> bigint) <span class="keyword">from</span> lxw_dual;</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>2019.01.05 北京 晴 手敲得疼</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/01/04/详解Java中的synchronized/" rel="next" title="详解Java中的synchronized">
                <i class="fa fa-chevron-left"></i> 详解Java中的synchronized
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/01/08/Hive的使用/" rel="prev" title="Hive的使用">
                Hive的使用 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      
        <div id="gitment-container"></div>
      
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar-6.png" alt="Jony Chiao">
            
              <p class="site-author-name" itemprop="name">Jony Chiao</p>
              <p class="site-description motion-element" itemprop="description">bulabula</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">83</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/jiaoqiyuan" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:jijujiu@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#关系运算"><span class="nav-number">1.</span> <span class="nav-text">关系运算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数学运算"><span class="nav-number">2.</span> <span class="nav-text">数学运算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#逻辑运算"><span class="nav-number">3.</span> <span class="nav-text">逻辑运算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数值计算"><span class="nav-number">4.</span> <span class="nav-text">数值计算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#日期函数"><span class="nav-number">5.</span> <span class="nav-text">日期函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#条件函数"><span class="nav-number">6.</span> <span class="nav-text">条件函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#字符串函数"><span class="nav-number">7.</span> <span class="nav-text">字符串函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#集合统计函数"><span class="nav-number">8.</span> <span class="nav-text">集合统计函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#复合类型构建函数"><span class="nav-number">9.</span> <span class="nav-text">复合类型构建函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#复杂类型访问操作"><span class="nav-number">10.</span> <span class="nav-text">复杂类型访问操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#复杂类型长度统计函数"><span class="nav-number">11.</span> <span class="nav-text">复杂类型长度统计函数</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jony Chiao</span>

  
</div>





        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i> 访问人数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> 访问总量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
